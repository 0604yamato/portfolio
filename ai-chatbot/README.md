# AIチャットボットシステム

Webサイトに埋め込み可能なAIチャットボットシステムです。
Google Dialogflow CXとDify APIを組み合わせた構成で、LINE Bot連携も可能です。

## アーキテクチャ

```
┌─────────────────────────────────────────────────────┐
│                   Webサイト                          │
│  ┌─────────────────────────────────────────────┐   │
│  │     Dialogflow CX Messenger                  │   │
│  │     （フロントエンドチャットUI）              │   │
│  └─────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────┘
                        │
                        ▼
┌─────────────────────────────────────────────────────┐
│              Google Cloud Run                        │
│  ┌─────────────────────────────────────────────┐   │
│  │         Express.js Proxy Server              │   │
│  │         - /api/chat (Dify連携)               │   │
│  │         - /webhook (LINE Bot)                │   │
│  └─────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────┘
                        │
          ┌─────────────┴─────────────┐
          ▼                           ▼
┌───────────────────┐       ┌───────────────────┐
│     Dify API      │       │    LINE Bot API   │
│   (LLMバックエンド)│       │                   │
└───────────────────┘       └───────────────────┘
```

## 機能

- **24時間自動応答**: Webサイト訪問者の質問に即時回答
- **自然言語理解**: Dialogflow CXによる高精度な意図認識
- **LLM統合**: Dify経由でGPT/Gemini等の大規模言語モデルを活用
- **LINE連携**: LINE公式アカウントとのチャットボット統合
- **1タグ埋め込み**: Webサイトへの簡単導入

## ファイル構成

```
ai-chatbot/
├── server.js           # Express.jsプロキシサーバー
├── Dockerfile          # コンテナ設定
├── package.json        # 依存パッケージ
├── DEPLOY.md           # デプロイ手順
├── chatbot-sample.html # チャットボットUIサンプル
├── .env.example        # 環境変数テンプレート
└── README.md
```

## 使用技術

- **Node.js 18** - ランタイム
- **Express.js** - Webフレームワーク
- **Dify API** - LLMオーケストレーション
- **Google Dialogflow CX** - 会話AI
- **LINE Bot SDK** - LINE連携
- **Docker** - コンテナ化
- **Google Cloud Run** - サーバーレスデプロイ

## セットアップ

### ローカル開発

```bash
# 依存パッケージのインストール
npm install

# 環境変数の設定
cp .env.example .env
# .envを編集してAPIキーを設定

# サーバー起動
npm start
```

### Cloud Runへのデプロイ

詳細は `DEPLOY.md` を参照してください。

## 環境変数

| 変数名 | 説明 | 必須 |
|--------|------|------|
| `DIFY_API_KEY` | Dify APIキー | ○ |
| `LINE_CHANNEL_SECRET` | LINEチャネルシークレット | △ |
| `LINE_CHANNEL_ACCESS_TOKEN` | LINEアクセストークン | △ |
| `PORT` | サーバーポート（デフォルト: 8080） | - |

## ライセンス

MIT License

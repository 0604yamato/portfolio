# 業務自動化システム

> Google Apps Script + Chatwork API による営業管理・業務効率化

## 概要

長期インターン先のクライアント企業向けに開発した、営業管理業務を自動化するシステム群です。
Google スプレッドシートを基盤とし、顧客対応の漏れ防止・データ管理の効率化を実現しました。

---

## 1. 顧客対応アラート通知システム

### 課題

- 営業担当者が顧客への次回アクション日を超過していても気づかない
- 対応漏れによる機会損失が発生

### 解決策

Google スプレッドシートの顧客データを監視し、対応期限を超過した顧客をChatworkに自動通知するシステムを開発。

### システム構成

```
┌─────────────────┐      ┌─────────────────┐      ┌─────────────────┐
│ Google Sheets   │─────▶│ Apps Script     │─────▶│   Chatwork      │
│  (顧客データ)    │      │  (判定・通知)    │      │  (アラート送信)  │
└─────────────────┘      └─────────────────┘      └─────────────────┘
         │
         ▼ トリガー（毎日9時）
```

### 主な機能

| 機能 | 説明 |
|------|------|
| 超過検出 | 次回アクション日を超過した顧客を自動検出 |
| 除外処理 | 「失注」「成約」ステータスの顧客は通知対象から除外 |
| Chatwork通知 | 超過日数・担当者・次回アクション内容を整形して通知 |
| 定期実行 | 毎日午前9時に自動実行（時刻カスタマイズ可能） |

### 技術スタック

- Google Apps Script
- Chatwork API
- Google Sheets API
- 時間ベーストリガー

### 成果

- 対応漏れの削減
- 営業担当者の確認作業を自動化

---

## 2. 要対応リスト自動生成システム

### 課題

- 顧客データが大量にあり、対応が必要な顧客を一覧で把握しづらい
- 手動での確認作業に時間がかかる

### 解決策

対応期限を超過した顧客を自動抽出し、専用シートに一覧表示。視覚的に優先度がわかるシステムを開発。

### 主な機能

| 機能 | 説明 |
|------|------|
| 自動抽出 | 次回アクション日超過の顧客を自動検出 |
| 一覧表示 | 「要対応リスト」シートに超過日数順で表示 |
| 色分け | 超過日数に応じて色分け表示（視認性向上） |
| 警告マーク | 元データシートに警告マークを自動追加 |
| カスタムメニュー | スプレッドシートにメニュー追加（手動更新・設定） |

### 技術スタック

- Google Apps Script
- Google Sheets API
- カスタムメニュー / UI機能

---

## 3. 見積書管理・データ同期システム

### 課題

- 管理者と担当者でデータが分散し、情報の同期が手作業
- 見積書の履歴管理ができておらず、過去の見積を検索できない

### 解決策

スプレッドシート間のデータ同期と、見積書の履歴保存・検索機能を実装。

### システム構成

```
┌─────────────────┐                  ┌─────────────────┐
│  管理者シート    │─────同期─────▶│  担当者Aシート   │
│  (マスターデータ) │                  │  (個別データ)    │
└─────────────────┘                  └─────────────────┘
         │
         ▼
┌─────────────────┐
│   履歴シート     │
│ (見積書アーカイブ) │
└─────────────────┘
```

### 主な機能

| 機能 | 説明 |
|------|------|
| データ同期 | 管理者シート → 担当者シートへワンクリック同期 |
| 履歴保存 | 見積書を履歴シートに自動保存 |
| 検索機能 | 顧客名・案件名・日付でフィルタリング |
| カスタムメニュー | スプレッドシートにメニュー追加 |

### 技術スタック

- Google Apps Script
- Google Sheets API（複数スプレッドシート連携）
- カスタムメニュー / UI機能

---

## 使用技術まとめ

| カテゴリ | 技術 |
|---------|------|
| 言語 | Google Apps Script (JavaScript) |
| API連携 | Chatwork API, Google Sheets API |
| 自動化 | 時間ベーストリガー、イベントトリガー |
| UI | カスタムメニュー、アラートダイアログ |

---

## 工夫した点

1. **汎用性の高い設計**: 設定ファイル（CONFIG）で各種パラメータを一元管理し、別の顧客データにも適用可能
2. **エラーハンドリング**: API通信エラー時のリトライ処理、権限エラーの検出
3. **運用効率化**: カスタムメニューによるワンクリック操作、定期実行の自動設定機能
4. **除外ロジック**: 失注・成約顧客を除外し、不要な通知を防止

---

## 学んだこと

- Google Apps Script を活用した業務自動化の設計・実装
- 外部API（Chatwork）との連携
- 複数スプレッドシート間のデータ同期
- トリガーによる定期実行の設定と管理
- 実際の業務課題をヒアリングし、技術で解決するプロセス
